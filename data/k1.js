var k1 = {
	title: "k1",
	bounds: {
		min: [58.0, 26.0],
		max: [1425.0, 1387.0]
	},
	points: [
		[653.0, 1327.0],
		[792.0, 1243.0],
		[885.0, 1099.0],
		[898.0, 927.0],
		[848.0, 831.0],
		[775.0, 800.0],
		[699.0, 819.0],
		[630.0, 864.0],
		[597.0, 931.0],
		[592.0, 996.0],
		[615.0, 1047.0],
		[662.0, 1042.0],
		[693.0, 1022.0],
		[717.0, 982.0],
		[704.0, 935.0],
		[678.0, 915.0],
		[655.0, 944.0],
		[661.0, 988.0],
		[678.0, 1012.0],
		[736.0, 1038.0],
		[773.0, 1033.0],
		[791.0, 995.0],
		[789.0, 930.0],
		[769.0, 883.0],
		[726.0, 834.0],
		[662.0, 804.0],
		[623.0, 801.0],
		[576.0, 824.0],
		[535.0, 877.0],
		[509.0, 976.0],
		[531.0, 1119.0],
		[562.0, 1216.0],
		[623.0, 1291.0],
		[722.0, 1362.0],
		[840.0, 1384.0],
		[962.0, 1372.0],
		[1052.0, 1322.0],
		[1117.0, 1244.0],
		[1137.0, 1196.0],
		[1137.0, 1138.0],
		[1113.0, 1086.0],
		[1063.0, 1060.0],
		[1027.0, 1092.0],
		[1021.0, 1138.0],
		[1053.0, 1185.0],
		[1101.0, 1207.0],
		[1160.0, 1216.0],
		[1244.0, 1165.0],
		[1350.0, 1056.0],
		[1406.0, 929.0],
		[1423.0, 832.0],
		[1402.0, 738.0],
		[1367.0, 664.0],
		[1298.0, 600.0],
		[1194.0, 556.0],
		[1090.0, 567.0],
		[1032.0, 606.0],
		[1007.0, 644.0],
		[1025.0, 692.0],
		[1093.0, 736.0],
		[1165.0, 742.0],
		[1223.0, 712.0],
		[1233.0, 677.0],
		[1210.0, 641.0],
		[1152.0, 634.0],
		[1090.0, 648.0],
		[1035.0, 678.0],
		[1015.0, 726.0],
		[1040.0, 772.0],
		[1095.0, 803.0],
		[1178.0, 808.0],
		[1265.0, 763.0],
		[1348.0, 699.0],
		[1392.0, 586.0],
		[1385.0, 477.0],
		[1352.0, 380.0],
		[1300.0, 310.0],
		[1216.0, 256.0],
		[1161.0, 230.0],
		[1081.0, 226.0],
		[1020.0, 271.0],
		[1007.0, 317.0],
		[1030.0, 351.0],
		[1087.0, 365.0],
		[1133.0, 334.0],
		[1160.0, 266.0],
		[1157.0, 197.0],
		[1115.0, 122.0],
		[1058.0, 79.0],
		[926.0, 26.0],
		[798.0, 32.0],
		[671.0, 101.0],
		[533.0, 265.0],
		[495.0, 411.0],
		[507.0, 549.0],
		[576.0, 672.0],
		[644.0, 695.0],
		[756.0, 630.0],
		[813.0, 532.0],
		[820.0, 445.0],
		[788.0, 385.0],
		[754.0, 380.0],
		[711.0, 400.0],
		[682.0, 482.0],
		[699.0, 542.0],
		[724.0, 554.0],
		[750.0, 541.0],
		[762.0, 483.0],
		[744.0, 434.0],
		[689.0, 386.0],
		[647.0, 382.0],
		[613.0, 411.0],
		[597.0, 486.0],
		[625.0, 571.0],
		[671.0, 643.0],
		[748.0, 699.0],
		[820.0, 711.0],
		[870.0, 672.0],
		[923.0, 517.0],
		[886.0, 334.0],
		[815.0, 218.0],
		[752.0, 151.0],
		[573.0, 73.0],
		[469.0, 71.0],
		[370.0, 114.0],
		[309.0, 164.0],
		[279.0, 239.0],
		[290.0, 308.0],
		[339.0, 355.0],
		[399.0, 352.0],
		[411.0, 304.0],
		[374.0, 235.0],
		[328.0, 209.0],
		[259.0, 204.0],
		[176.0, 246.0],
		[118.0, 316.0],
		[75.0, 473.0],
		[88.0, 589.0],
		[153.0, 744.0],
		[241.0, 817.0],
		[341.0, 835.0],
		[446.0, 792.0],
		[479.0, 739.0],
		[474.0, 704.0],
		[436.0, 657.0],
		[377.0, 635.0],
		[313.0, 653.0],
		[271.0, 701.0],
		[277.0, 738.0],
		[315.0, 759.0],
		[373.0, 754.0],
		[430.0, 719.0],
		[467.0, 659.0],
		[474.0, 616.0],
		[439.0, 567.0],
		[380.0, 539.0],
		[276.0, 538.0],
		[196.0, 578.0],
		[139.0, 661.0],
		[74.0, 801.0],
		[58.0, 969.0],
		[91.0, 1123.0],
		[166.0, 1197.0],
		[273.0, 1230.0],
		[339.0, 1202.0],
		[403.0, 1111.0],
		[408.0, 1039.0],
		[381.0, 1003.0],
		[316.0, 1013.0],
		[258.0, 1059.0],
		[230.0, 1128.0],
		[220.0, 1196.0],
		[234.0, 1246.0],
		[315.0, 1330.0],
		[417.0, 1369.0],
		[506.0, 1375.0],
		[654.0, 1327.0]
	]
}; 
var ctx,raf;
var eps = 0.025;
var kk=1,tt=0.0;
var X,Y;

function P(p,l,t,k) { return(
	p[k][l]+ 
	0.5*(p[k+1][l]-p[k-1][l])*t- 
	0.5*(p[k+2][l]-4*p[k+1][l]+5*p[k][l]-2*p[k-1][l])*t*t+ 
	0.5*(p[k+2][l]-3*p[k+1][l]+3*p[k][l]-p[k-1][l])*t*t*t);
}

function fit(data, cxs, cys) {	
	var dxs = data.bounds.max[0]-data.bounds.min[0];
	var dys = data.bounds.max[1]-data.bounds.min[1];
	var sx = dxs/cxs;
	var sy = dys/cys;
	if(dxs > cxs) {
		sx=1.0/sx;
		sy=1.0/sy;
	}	
	for(let i=0; i<data.points.length; i++) {
		data.points[i][0]*=sx;
		data.points[i][1]*=sy;
	}
}

function cls3(data) {
	data.points.push(data.points[0]);
	data.points.push(data.points[1]);
	data.points.push(data.points[2]);
}

function draw() {  
  var canvas = document.getElementById('canvas');
  canvas.width = window.screen.availWidth;
  canvas.height= window.screen.availHeight;
  fit(k1,canvas.width-200,canvas.height-200);
  cls3(k1);
  if (canvas.getContext) {
	ctx = canvas.getContext('2d');
	var p=k1.points;
	
	/* 
	* Display initial points 
	*/
	ctx.fillStyle = 'blue';
	ctx.beginPath();
	//ctx.moveTo(p[0][0], p[0][1]);
	ctx.fillRect(p[0][0],p[0][1],4,4);	
	for(let i=1; i<p.length; i++) {
		//ctx.lineTo(p[i][0], p[i][1]);
		ctx.fillRect(p[i][0],p[i][1],4,4);
	}
	ctx.stroke();

	ctx.fillStyle = 'red';	
	raf = window.requestAnimationFrame(animcurve);
  }
}

function animcurve() {	
	if(kk<k1.points.length-1) {
		if(tt<=1.0) {
			X=P(k1.points,0,tt,kk);
			Y=P(k1.points,1,tt,kk);
			ctx.fillRect(X,Y,2,2);	
			tt+=eps;		
		}
		else {
			tt=0.0;
			kk++;
		}
		raf = window.requestAnimationFrame(animcurve);
	}
	else window.cancelAnimationFrame(raf);
}